import{j as e,r as b,S as O,V as x,m as z,K as G}from"./app-Dm1u0AXE.js";import{c as M,f as R}from"./utils-7joyUr45.js";import{B as y}from"./badge-BLnBBCyz.js";import{D as P,a as B,b as I,c as K}from"./dialog-CQTkj3Q3.js";import{I as T}from"./input-error-DJ4-iW0F.js";import{u as H,A as V,a as F,b as L}from"./avatar-Co27TjxE.js";import{B as m}from"./button-B8HR8UnQ.js";import{C as w,a as D,b as _,c as E}from"./card-1ZUrRkMv.js";import{T as W,a as Y}from"./triangle-alert-DrIj-pAy.js";import{f as h,i as u}from"./id-CN8iUG6p.js";import{A as N,a as v}from"./alert-CYdpJEFU.js";import{L as A}from"./label-CZMCKa80.js";import{S as q,a as J,b as Q,c as U,d as X,e as o}from"./select-BV8vy61L.js";import{T as Z}from"./textarea-DTTXRLDC.js";import{h as k}from"./helpers-Bw55Ac1T.js";import{A as $}from"./app-layout-CAbBR3R4.js";import ee from"./form-tanggapan-sGVixhur.js";import"./index-B3UD-b76.js";import"./createLucideIcon-HjjLzNTO.js";import"./index-Cvxo1Tyn.js";import"./tslib.es6-BUas5LQb.js";import"./index-DMwGX5xR.js";import"./index-D0x30HOr.js";import"./index-Erq2rinb.js";import"./index-CfPmvE3t.js";import"./floating-ui.react-dom-emiYphFk.js";import"./index-tPyEvuwo.js";import"./check-BQDKagVc.js";import"./use-mobile-DDc2PveU.js";import"./index-DetlAbs5.js";import"./app-logo-icon-BsEkKcaF.js";function se({pengaduan:s,className:i}){return e.jsxs("div",{className:M("space-y-0.5",i),children:[e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("h2",{className:"max-w-xl text-xl font-semibold tracking-tight",children:s.judul}),e.jsx(y,{variant:"outline",children:s.bidang})]}),s.isi&&e.jsx("p",{className:"mt-2 text-sm leading-6 text-gray-600",children:s.isi}),e.jsx("div",{className:"mt-5 flex max-w-xl",children:s.berkas.map((r,t)=>e.jsxs(P,{children:[e.jsx(B,{children:e.jsxs("div",{className:"flex max-w-fit gap-x-2 rounded-lg px-3 py-1.5 hover:bg-gray-100",children:[e.jsx("div",{className:"h-11 w-8 overflow-hidden",children:e.jsx("img",{src:"/storage/"+r.path_berkas,alt:"Berkas"})}),e.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-800",children:["Berkas ",t+1]}),e.jsx("span",{className:"text-sm text-gray-600",children:R(r.size)})]})]})}),e.jsx(I,{className:"overflow-hidden",children:e.jsx("img",{src:"/storage/"+r.path_berkas,alt:"Berkas"})})]}))})]})}function ae({items:s}){const i=H(),[r,t]=b.useState(!1),[S,C]=b.useState(!1),[g,l]=b.useState(null),j=a=>{O.delete(route("tanggapan.destroy",{tanggapan:a}),{preserveState:!0,onSuccess:()=>{x.success("Berhasil menghapus tanggapan"),t(!1),l(null)},onError:n=>{x.error(n[0]),l(null),t(!1)}})};return e.jsx("div",{className:"relative space-y-6 border-l-2 border-dashed border-blue-500 pl-6",children:s.map((a,n)=>{const p=h(a.created_at,"EEEE, d MMMM y",{locale:u}),d=h(a.created_at,"HH:mm",{locale:u});return e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute top-1 -left-[31px] h-3 w-3 rounded-full border-2 border-white bg-blue-500"}),e.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[e.jsx("div",{className:"text-sm font-semibold text-blue-600",children:p}),e.jsx("div",{className:"text-xs text-gray-500",children:d})]}),e.jsx(w,{children:e.jsxs(D,{className:"flex gap-4",children:[e.jsxs(V,{className:"h-8 w-8 overflow-hidden rounded-full",children:[e.jsx(F,{src:"/storage/"+a.user.avatar,alt:a.user.name}),e.jsx(L,{className:"rounded-lg bg-neutral-200 text-black dark:bg-neutral-700 dark:text-white",children:i(a.user.name)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",children:a.user.name}),e.jsx("p",{className:"text-xs text-gray-500",children:a.user.roles})]})}),e.jsx("p",{className:"mt-2 text-sm",children:a.tanggapan})]}),e.jsxs(P,{open:g===a.id,onOpenChange:f=>l(f?a.id:null),children:[e.jsx(B,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"sm",children:e.jsx(W,{className:"h-4 w-4 text-red-500"})})}),e.jsx(I,{className:"sm:max-w-[425px]",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-full bg-red-200",children:e.jsx(Y,{className:"h-8 w-8 text-red-500"})}),e.jsx("h1",{className:"mt-4 text-lg font-bold",children:"Hapus Tanggapan"}),e.jsx("p",{className:"mt-2 text-gray-400",children:"Apakah Anda yakin ingin menghapus ini?"}),e.jsxs("div",{className:"mt-4 grid w-full grid-cols-2 gap-x-2",children:[e.jsx(K,{asChild:!0,children:e.jsx(m,{variant:"outline",children:"Batal"})}),e.jsx(m,{variant:"default",className:"bg-red-500 transition-all duration-300 hover:bg-red-600 active:scale-90",disabled:r,onClick:()=>{t(!0),j(a)},"aria-label":"Delete row",children:"Ya, saya yakin!"})]})]})})]})]})})]},a.id)})})}const te=[{title:"Pengaduan",href:route("pengaduan.index")},{title:"Detail Pengaduan",href:"#"}],re={Diajukan:"bg-yellow-500 text-yellow-100",Diproses:"bg-blue-500 text-blue-100",Selesai:"bg-green-500 text-green-100",Ditolak:"bg-red-500 text-red-100"};function He({pengaduan:s}){const i=h(s.created_at,"EEEE, d MMMM y",{locale:u}),r=h(s.latest_status.created_at,"EEEE, d MMMM y",{locale:u}),t=s.user,S=H(),C=re[s.latest_status.status]??"bg-gray-500 text-white",{data:g,setData:l,put:j,processing:a,errors:n,reset:p}=z({status:"",tindakan:""}),{auth:d}=G().props,f=c=>{c.preventDefault(),j(route("pengaduan.update",{pengaduan:s}),{onSuccess:()=>{x.success("Berhasil memperbarui status"),p()},onError:()=>x.error("Gagal memperbarui status")})};return e.jsx($,{breadcrumbs:te,children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsxs("div",{className:"flex w-full gap-x-5 not-lg:flex-col not-lg:gap-y-3",children:[e.jsxs("div",{className:"w-full max-w-4xl not-lg:order-2",children:[s.validasi_rektor===1?e.jsx(N,{className:"mb-3 border-green-500 bg-green-100",children:e.jsx(v,{className:"justify-center text-gray-800",children:e.jsx("span",{className:"font-bold",children:"Telah divalidasi rektor"})})}):s.validasi_rektor===0?e.jsx(N,{className:"mb-3 border-red-500 bg-red-100",children:e.jsx(v,{className:"justify-center text-gray-800",children:e.jsx("span",{className:"font-bold",children:"Telah ditolak rektor"})})}):e.jsx(N,{className:"mb-3 border-yellow-500 bg-yellow-100",children:e.jsx(v,{className:"justify-center text-gray-800",children:e.jsx("span",{className:"font-bold",children:"Menunggu validasi rektor"})})}),e.jsx(se,{pengaduan:s,className:"border-b pb-3"}),e.jsx("div",{className:"mt-2 mb-5",children:e.jsx(y,{className:"border border-blue-300 bg-blue-50 text-blue-500",children:"Tanggapan"})}),k(d.user,["admin","warek_1","warek_2","warek_3","rektor"])&&e.jsx(ee,{pengaduan:s}),e.jsx(ae,{items:s.tanggapans})]}),e.jsxs("div",{className:"w-full space-y-5 lg:max-w-sm",children:[e.jsxs(w,{className:"shadow-none",children:[e.jsx(_,{children:e.jsx(E,{children:"Info Pengaduan"})}),e.jsxs(D,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Status:"}),e.jsx(y,{className:M(C),children:s.latest_status.status})]}),s.latest_status.tindakan&&e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tindakan:"}),e.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.latest_status.tindakan})]}),e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Diajukan:"}),e.jsx("p",{className:"text-sm font-medium text-gray-800",children:i})]}),e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pembaruan Terakhir:"}),e.jsx("p",{className:"text-sm font-medium text-gray-800",children:r})]})]}),k(d.user,["admin","warek_1","warek_2","warek_3"])&&e.jsxs("div",{className:"mt-5 space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800",children:"Pengaduan dari:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(V,{className:"h-8 w-8 overflow-hidden rounded-full",children:[e.jsx(F,{src:"/storage/"+t.avatar,alt:t.name}),e.jsx(L,{className:"rounded-lg bg-neutral-200 text-black dark:bg-neutral-700 dark:text-white",children:S(t.name)})]}),e.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[e.jsx("span",{className:"truncate font-semibold text-blue-500",children:t.name}),e.jsx("span",{className:"text-muted-foreground truncate text-xs",children:t.nim})]})]})]})]})]}),k(d.user,["admin"])&&e.jsxs(w,{className:"shadow-none",children:[e.jsx(_,{children:e.jsx(E,{children:"Perbarui Status"})}),e.jsx(D,{children:e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(A,{children:"Status"}),e.jsxs(q,{onValueChange:c=>l("status",c),children:[e.jsx(J,{className:"w-full",children:e.jsx(Q,{placeholder:"Pilih status baru"})}),e.jsx(U,{children:e.jsxs(X,{children:[e.jsx(o,{value:"Diajukan",children:"Diajukan"}),e.jsx(o,{value:"Diproses",children:"Diproses"}),e.jsx(o,{value:"Selesai",children:"Selesai"}),e.jsx(o,{value:"Ditolak",children:"Ditolak"})]})}),e.jsx(T,{message:n.status})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(A,{htmlFor:"tindakan",children:"Tindakan"}),e.jsx(Z,{id:"tindakan",value:g.tindakan,onChange:c=>l("tindakan",c.target.value)}),e.jsx(T,{message:n.tindakan})]}),e.jsx(m,{disabled:a,children:"Simpan"})]})})]})]})]})})})}export{He as default};
